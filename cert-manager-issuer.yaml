apiVersion: certmanager.k8s.io/v1alpha1
kind: ClusterIssuer
metadata:
  name: le-staging
spec:
  acme:
    email: cluster11issuer@seankhliao.com
    server: https://acme-staging-v02.api.letsencrypt.org/directory
    privateKeySecretRef:
      name: le-staging
    solvers:
      - dns01:
          selector:
            matchLabels:
              use-cloudflare-solver: "true"
          cloudflare:
            email: seankhliao@gmail.com
            apiKeySecretRef:
              name: cloudflare
              key: cloudflare_key
---
apiVersion: certmanager.k8s.io/v1alpha1
kind: Certificate
metadata:
  name: acme-staging-crt
  labels:
    use-cloudflare-solver: "true"
spec:
  secretName: acme-staging-crt-secret
  dnsNames:
    - api.seankhliao.com
  issuerRef:
    name: le-staging
    kind: ClusterIssuer
---
apiVersion: certmanager.k8s.io/v1alpha1
kind: ClusterIssuer
metadata:
  name: le-prod
spec:
  acme:
    email: cluster11issuer@seankhliao.com
    server: https://acme-v02.api.letsencrypt.org/directory
    privateKeySecretRef:
      name: le-prod
    solvers:
      - dns01:
          selector:
            matchLabels:
              use-cloudflare-solver: "true"
          cloudflare:
            email: seankhliao@gmail.com
            apiKeySecretRef:
              name: cloudflare
              key: cloudflare_key
---
apiVersion: certmanager.k8s.io/v1alpha1
kind: Certificate
metadata:
  name: acme-prod-crt
  labels:
    use-cloudflare-solver: "true"
spec:
  secretName: acme-prod-crt-secret
  dnsNames:
    - api.seankhliao.com
  issuerRef:
    name: le-prod
    kind: ClusterIssuer
